<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ‡¶∞‡ßç‡¶•‡ßÄ ‡¶õ‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ‡¶™‡¶§‡ßç‡¶∞</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{min-height:100vh;background:linear-gradient(135deg,#11998e,#38ef7d);padding:20px;font-family:'Noto Sans Bengali',Arial,sans-serif}
        .header{text-align:center;margin-bottom:30px;color:white}
        .header h1{font-size:32px;margin-bottom:10px;text-shadow:2px 2px 4px rgba(0,0,0,.3)}
        .header p{font-size:16px;opacity:.9}
        .container{display:flex;gap:30px;max-width:1400px;margin:0 auto;flex-wrap:wrap;justify-content:center}
        .form-card,.output-card{flex:1;min-width:350px;max-width:500px;background:white;border-radius:15px;padding:25px;box-shadow:0 10px 40px rgba(0,0,0,.2)}
        .form-card h2,.output-card h2{color:#4a5568;margin-bottom:20px;padding-bottom:10px;border-bottom:2px solid #e2e8f0;font-size:20px}
        .form-group{margin-bottom:15px}
        .form-group label{display:block;margin-bottom:5px;color:#4a5568;font-weight:500}
        .form-group input,.form-group select,.form-group textarea{width:100%;padding:12px;border:2px solid #e2e8f0;border-radius:8px;font-size:16px;outline:none;transition:border-color .3s}
        .form-group input:focus,.form-group select:focus,.form-group textarea:focus{border-color:#11998e}
        .leave-duration{display:flex;gap:15px;margin-bottom:15px;padding:15px;background:#f0fff4;border-radius:10px;border:1px solid #9ae6b4}
        .leave-duration label{display:flex;align-items:center;gap:8px;cursor:pointer;padding:10px 20px;border-radius:8px;transition:all .3s;border:2px solid transparent}
        .leave-duration label:hover{background:#c6f6d5}
        .leave-duration input[type="radio"]{width:18px;height:18px;cursor:pointer}
        .leave-duration input[type="radio"]:checked+span{font-weight:600;color:#11998e}
        .leave-duration label:has(input:checked){background:#9ae6b4;border-color:#11998e}
        .date-group{display:flex;gap:10px}
        .date-group .form-group{flex:1}
        .single-date{max-width:50%}
        .btn-group{display:flex;gap:10px;margin-top:20px}
        .btn-primary{flex:1;padding:14px;background:linear-gradient(135deg,#11998e,#38ef7d);color:white;border:none;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer;transition:transform .2s,box-shadow .2s}
        .btn-primary:hover{transform:translateY(-2px);box-shadow:0 5px 20px rgba(0,0,0,.2)}
        .btn-reset{padding:14px 20px;background:#e2e8f0;color:#4a5568;border:none;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer}
        .btn-print{padding:12px 24px;background:linear-gradient(135deg,#667eea,#764ba2);color:white;border:none;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer}
        .output-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding-bottom:10px;border-bottom:2px solid #e2e8f0}
        .application-letter{padding:var(--margin-size,20px);border:1px solid #e2e8f0;border-radius:8px;line-height:var(--line-height,2);font-size:var(--font-size,16px)}
        .slider-control{background:#f8f9fa;padding:15px;border-radius:10px;margin-bottom:15px}
        .slider-control label{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;color:#4a5568;font-weight:500}
        .slider{width:100%;height:8px;border-radius:4px;outline:none;-webkit-appearance:none;cursor:pointer}
        .margin-slider{background:linear-gradient(to right,#e2e8f0,#11998e)}
        .lineheight-slider{background:linear-gradient(to right,#e2e8f0,#667eea)}
        .fontsize-slider{background:linear-gradient(to right,#e2e8f0,#e74c3c)}
        .slider::-webkit-slider-thumb{-webkit-appearance:none;width:24px;height:24px;border-radius:50%;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,.2)}
        .margin-slider::-webkit-slider-thumb{background:linear-gradient(135deg,#11998e,#38ef7d)}
        .lineheight-slider::-webkit-slider-thumb{background:linear-gradient(135deg,#667eea,#764ba2)}
        .fontsize-slider::-webkit-slider-thumb{background:linear-gradient(135deg,#e74c3c,#c0392b)}
        .slider-value{padding:4px 12px;border-radius:20px;font-size:14px;font-weight:600;color:white}
        .margin-value{background:#11998e}.lineheight-value{background:#667eea}.fontsize-value{background:#e74c3c}
        .letter-date{text-align:right;margin-bottom:15px}
        .letter-subject{margin-bottom:15px}
        .letter-body{text-indent:40px;text-align:justify;margin-bottom:15px}
        .letter-signature{text-align:right;margin-top:40px}
        .placeholder{padding:40px;text-align:center;color:#718096}
        .placeholder-icon{font-size:60px;margin-bottom:20px}
        .footer{text-align:center;margin-top:30px;color:white;opacity:.8;font-size:14px}
        .hidden{display:none!important}
        .info-row{display:flex;gap:10px}
        .info-row .form-group{flex:1}
        
        /* Saved Apps Section */
        .saved-section{background:#e8f5e9;padding:15px;border-radius:10px;margin-top:15px;border:1px solid #4caf50}
        .saved-section h3{color:#2e7d32;font-size:14px;margin-bottom:10px}
        .save-name-input{display:flex;gap:10px;margin-bottom:10px}
        .save-name-input input{flex:1;padding:10px;border:2px solid #c8e6c9;border-radius:8px;font-size:14px}
        .btn-save{padding:10px 15px;background:linear-gradient(135deg,#4caf50,#2e7d32);color:white;border:none;border-radius:8px;font-size:14px;font-weight:600;cursor:pointer}
        .saved-list{max-height:200px;overflow-y:auto;border:1px solid #c8e6c9;border-radius:8px;margin-bottom:10px}
        .saved-item{display:flex;justify-content:space-between;align-items:center;padding:10px;border-bottom:1px solid #e8f5e9;background:white;cursor:pointer}
        .saved-item:hover{background:#f1f8e9}
        .saved-item:last-child{border-bottom:none}
        .saved-info{flex:1}
        .saved-name{font-weight:600;color:#333;font-size:14px}
        .saved-date{font-size:11px;color:#666}
        .saved-actions{display:flex;gap:5px}
        .btn-load{padding:5px 10px;background:#2196f3;color:white;border:none;border-radius:5px;font-size:11px;cursor:pointer}
        .btn-delete{padding:5px 10px;background:#f44336;color:white;border:none;border-radius:5px;font-size:11px;cursor:pointer}
        .no-saved{padding:20px;text-align:center;color:#666;font-size:13px}
        .counter{font-size:12px;color:#2e7d32;margin-bottom:10px}
        .export-import{display:flex;gap:10px}
        .btn-export{flex:1;padding:10px;background:linear-gradient(135deg,#9c27b0,#7b1fa2);color:white;border:none;border-radius:8px;font-size:13px;font-weight:600;cursor:pointer}
        .btn-import{flex:1;padding:10px;background:linear-gradient(135deg,#ff5722,#e64a19);color:white;border:none;border-radius:8px;font-size:13px;font-weight:600;cursor:pointer}
        
        /* Toast */
        .toast{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);padding:12px 24px;border-radius:8px;color:white;font-weight:600;z-index:9999;animation:fadeInOut 3s ease-in-out;box-shadow:0 5px 20px rgba(0,0,0,.2)}
        .toast-success{background:linear-gradient(135deg,#27ae60,#2ecc71)}
        .toast-error{background:linear-gradient(135deg,#e74c3c,#c0392b)}
        @keyframes fadeInOut{0%{opacity:0;transform:translateX(-50%) translateY(20px)}15%{opacity:1;transform:translateX(-50%) translateY(0)}85%{opacity:1;transform:translateX(-50%) translateY(0)}100%{opacity:0;transform:translateX(-50%) translateY(-20px)}}
        
        @media print{body{background:white;padding:0}.form-card,.header,.footer,.no-print,.output-header{display:none!important}.output-card{box-shadow:none;border:none;max-width:100%;padding:0}.application-letter{border:none}@page{margin:10mm;size:A4}}
        @media (max-width:768px){.container{flex-direction:column}.form-card,.output-card{max-width:100%}.date-group,.info-row{flex-direction:column}.single-date{max-width:100%}.leave-duration{flex-direction:column;gap:10px}.export-import{flex-direction:column}}
    </style>
</head>
<body>
    <div class="header">
        <h1>üéì ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ‡¶∞‡ßç‡¶•‡ßÄ ‡¶õ‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ‡¶™‡¶§‡ßç‡¶∞</h1>
        <p>‡¶´‡¶∞‡ßç‡¶Æ‡¶ü‡¶ø ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ‡¶™‡¶§‡ßç‡¶∞ ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</p>
    </div>
    <div class="container">
        <div class="form-card">
            <h2>üìù ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®</h2>
            <form id="leaveForm">
                <div class="form-group"><label>‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ‡¶∞‡ßç‡¶•‡ßÄ‡¶∞ ‡¶®‡¶æ‡¶Æ *</label><input type="text" id="studentName" placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶¨‡¶æ‡¶¨‡ßÅ‡¶≤ ‡¶Ü‡¶ï‡¶§‡¶æ‡¶∞ ‡¶ñ‡¶æ‡¶®" required></div>
                <div class="info-row">
                    <div class="form-group"><label>‡¶™‡¶ø‡¶§‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ *</label><input type="text" id="fatherName" placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶∞‡¶π‡¶ø‡¶Æ" required></div>
                    <div class="form-group"><label>‡¶Æ‡¶æ‡¶§‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ *</label><input type="text" id="motherName" placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶π‡¶æ‡¶∏‡¶®‡¶æ" required></div>
                </div>
                <div class="info-row">
                    <div class="form-group"><label>‡¶∂‡ßç‡¶∞‡ßá‡¶£‡¶ø *</label><input type="text" id="studentClass" placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: ‡ßØ‡¶Æ" required></div>
                    <div class="form-group"><label>‡¶∂‡¶æ‡¶ñ‡¶æ *</label><input type="text" id="section" placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶ï" required></div>
                </div>
                <div class="info-row">
                    <div class="form-group"><label>‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó</label><input type="text" id="department" placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶®"></div>
                    <div class="form-group"><label>‡¶∞‡ßã‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ *</label><input type="text" id="rollNo" placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: ‡ßØ‡ßÆ" required></div>
                </div>
                <div class="form-group"><label>‡¶õ‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶ß‡¶∞‡¶® *</label><select id="leaveType" required>
                    <option value="‡¶Ö‡¶∏‡ßÅ‡¶∏‡ßç‡¶•‡¶§‡¶æ ‡¶ú‡¶®‡¶ø‡¶§ ‡¶õ‡ßÅ‡¶ü‡¶ø">‡¶Ö‡¶∏‡ßÅ‡¶∏‡ßç‡¶•‡¶§‡¶æ ‡¶ú‡¶®‡¶ø‡¶§ ‡¶õ‡ßÅ‡¶ü‡¶ø</option>
                    <option value="‡¶¨‡¶æ‡¶°‡¶º‡¶ø‡¶∞ ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶õ‡ßÅ‡¶ü‡¶ø">‡¶¨‡¶æ‡¶°‡¶º‡¶ø‡¶∞ ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶õ‡ßÅ‡¶ü‡¶ø</option>
                    <option value="‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶õ‡ßÅ‡¶ü‡¶ø">‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶õ‡ßÅ‡¶ü‡¶ø</option>
                    <option value="‡¶õ‡ßÅ‡¶ü‡¶ø">‡¶õ‡ßÅ‡¶ü‡¶ø</option>
                </select></div>
                <div class="form-group"><label>‡¶õ‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶Æ‡ßá‡¶Ø‡¶º‡¶æ‡¶¶ *</label>
                    <div class="leave-duration">
                        <label><input type="radio" name="leaveDuration" value="single" checked onchange="toggleDateFields()"><span>üìÖ ‡¶è‡¶ï‡¶¶‡¶ø‡¶®‡ßá‡¶∞ ‡¶õ‡ßÅ‡¶ü‡¶ø</span></label>
                        <label><input type="radio" name="leaveDuration" value="multiple" onchange="toggleDateFields()"><span>üìÜ ‡¶è‡¶ï‡¶æ‡¶ß‡¶ø‡¶ï ‡¶¶‡¶ø‡¶®‡ßá‡¶∞ ‡¶õ‡ßÅ‡¶ü‡¶ø</span></label>
                    </div>
                </div>
                <div id="singleDaySection"><div class="form-group single-date"><label>‡¶õ‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ *</label><input type="date" id="singleDate" required></div></div>
                <div id="multipleDaySection" class="hidden">
                    <div class="date-group">
                        <div class="form-group"><label>‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ *</label><input type="date" id="startDate"></div>
                        <div class="form-group"><label>‡¶∂‡ßá‡¶∑‡ßá‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ *</label><input type="date" id="endDate"></div>
                    </div>
                    <div class="form-group"><label>‡¶Æ‡ßã‡¶ü ‡¶¶‡¶ø‡¶® *</label><input type="number" id="totalDays" placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: 3" min="1"></div>
                </div>
                <div class="form-group"><label>‡¶õ‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶ï‡¶æ‡¶∞‡¶£ *</label><textarea id="reason" rows="3" placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶Ö‡¶∏‡ßÅ‡¶∏‡ßç‡¶•‡¶§‡¶æ‡¶∞" required></textarea></div>
                <div class="form-group"><label>‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ‡¶≤‡¶Ø‡¶º‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ</label><input type="text" id="schoolName" value="‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£ ‡¶â‡¶ö‡ßç‡¶ö ‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ‡¶≤‡¶Ø‡¶º"></div>
                <div class="form-group"><label>‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ‡¶≤‡¶Ø‡¶º‡ßá‡¶∞ ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ</label><input type="text" id="schoolAddress" value="‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ: ‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£, ‡¶ú‡ßá‡¶≤‡¶æ: ‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£"></div>
                <div class="btn-group">
                    <button type="submit" class="btn-primary">üìÑ ‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                    <button type="button" class="btn-reset" onclick="resetForm()">üîÑ</button>
                </div>
                
                <!-- Saved Section -->
                <div class="saved-section">
                    <h3>üìã ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ ‡¶Ü‡¶¨‡ßá‡¶¶‡¶®</h3>
                    <div class="counter" id="counter">‡¶∏‡¶∞‡ßç‡¶¨‡¶Æ‡ßã‡¶ü: ‡ß¶‡¶ü‡¶ø</div>
                    <div class="save-name-input">
                        <input type="text" id="saveName" placeholder="‡¶®‡¶æ‡¶Æ ‡¶¶‡¶ø‡¶® (‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶¨‡¶æ‡¶¨‡ßÅ‡¶≤ ‡¶Ö‡¶∏‡ßÅ‡¶∏‡ßç‡¶•‡¶§‡¶æ)">
                        <button type="button" class="btn-save" onclick="saveApplication()">üíæ ‡¶∏‡ßá‡¶≠</button>
                    </div>
                    <div class="saved-list" id="savedList"><div class="no-saved">‡¶ï‡ßã‡¶®‡ßã ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ ‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ‡¶®‡ßá‡¶á</div></div>
                    <div class="export-import">
                        <button type="button" class="btn-export" onclick="exportJSON()">üì§ JSON ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°</button>
                        <button type="button" class="btn-import" onclick="document.getElementById('importFile').click()">üì• JSON ‡¶Ü‡¶™‡¶≤‡ßã‡¶°</button>
                        <input type="file" id="importFile" accept=".json" style="display:none" onchange="importJSON(event)">
                    </div>
                </div>
            </form>
        </div>
        <div class="output-card" id="outputCard">
            <div id="placeholder" class="placeholder"><div class="placeholder-icon">üìÑ</div><h3>‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ‡¶™‡¶§‡ßç‡¶∞ ‡¶™‡ßç‡¶∞‡¶ø‡¶≠‡¶ø‡¶â</h3><p>‡¶´‡¶∞‡ßç‡¶Æ‡¶ü‡¶ø ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßá "‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®" ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®</p></div>
            <div id="output" style="display:none">
                <div class="output-header no-print"><h2>üìã ‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ‡¶™‡¶§‡ßç‡¶∞ ‡¶™‡ßç‡¶∞‡¶ø‡¶≠‡¶ø‡¶â</h2><button class="btn-print" onclick="window.print()">üñ®Ô∏è ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</button></div>
                <div class="slider-control no-print"><label><span>üìè ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ú‡¶ø‡¶®:</span><span class="slider-value margin-value" id="marginValue">20px</span></label><input type="range" class="slider margin-slider" id="marginSlider" min="5" max="60" value="20" oninput="updateMargin(this.value)"></div>
                <div class="slider-control no-print"><label><span>üìù ‡¶≤‡¶æ‡¶á‡¶® ‡¶π‡¶æ‡¶á‡¶ü:</span><span class="slider-value lineheight-value" id="lineHeightValue">2.0</span></label><input type="range" class="slider lineheight-slider" id="lineHeightSlider" min="1.2" max="3" step="0.1" value="2" oninput="updateLineHeight(this.value)"></div>
                <div class="slider-control no-print"><label><span>üî§ ‡¶´‡¶®‡ßç‡¶ü ‡¶∏‡¶æ‡¶á‡¶ú:</span><span class="slider-value fontsize-value" id="fontSizeValue">16px</span></label><input type="range" class="slider fontsize-slider" id="fontSizeSlider" min="10" max="24" value="16" oninput="updateFontSize(this.value)"></div>
                <div class="application-letter" id="applicationLetter"></div>
            </div>
        </div>
    </div>
    <div class="footer">¬© 2024 ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ‡¶∞‡ßç‡¶•‡ßÄ ‡¶õ‡ßÅ‡¶ü‡¶ø‡¶∞ ‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ‡¶™‡¶§‡ßç‡¶∞ ‡¶ú‡ßá‡¶®‡¶æ‡¶∞‡ßá‡¶ü‡¶∞</div>
    <script>
        function toBengaliNumber(n){var d=['‡ß¶','‡ßß','‡ß®','‡ß©','‡ß™','‡ß´','‡ß¨','‡ß≠','‡ßÆ','‡ßØ'];return String(n).replace(/[0-9]/g,function(s){return d[parseInt(s)]})}
        function showToast(msg,type){var t=document.createElement('div');t.className='toast toast-'+type;t.textContent=msg;document.body.appendChild(t);setTimeout(function(){t.remove()},3000)}
        
        function toggleDateFields(){var i='single'===document.querySelector('input[name="leaveDuration"]:checked').value,s=document.getElementById('singleDaySection'),m=document.getElementById('multipleDaySection');i?(s.classList.remove('hidden'),m.classList.add('hidden'),document.getElementById('singleDate').required=!0,document.getElementById('startDate').required=!1,document.getElementById('endDate').required=!1,document.getElementById('totalDays').required=!1):(s.classList.add('hidden'),m.classList.remove('hidden'),document.getElementById('singleDate').required=!1,document.getElementById('startDate').required=!0,document.getElementById('endDate').required=!0,document.getElementById('totalDays').required=!0)}
        
        function getBengaliDate(){return new Date().toLocaleDateString('bn-BD',{year:'numeric',month:'long',day:'numeric'})}
        function formatDate(d){if(!d)return'';var t=new Date(d);return toBengaliNumber(t.getDate())+'/'+toBengaliNumber(t.getMonth()+1)+'/'+toBengaliNumber(t.getFullYear())}
        
        function getFormData(){
            return{
                studentName:document.getElementById('studentName').value,
                fatherName:document.getElementById('fatherName').value,
                motherName:document.getElementById('motherName').value,
                studentClass:document.getElementById('studentClass').value,
                section:document.getElementById('section').value,
                department:document.getElementById('department').value,
                rollNo:document.getElementById('rollNo').value,
                leaveType:document.getElementById('leaveType').value,
                leaveDuration:document.querySelector('input[name="leaveDuration"]:checked').value,
                singleDate:document.getElementById('singleDate').value,
                startDate:document.getElementById('startDate').value,
                endDate:document.getElementById('endDate').value,
                totalDays:document.getElementById('totalDays').value,
                reason:document.getElementById('reason').value,
                schoolName:document.getElementById('schoolName').value,
                schoolAddress:document.getElementById('schoolAddress').value,
                margin:document.getElementById('marginSlider').value,
                lineHeight:document.getElementById('lineHeightSlider').value,
                fontSize:document.getElementById('fontSizeSlider').value
            }
        }
        
        function loadFormData(data){
            document.getElementById('studentName').value=data.studentName||'';
            document.getElementById('fatherName').value=data.fatherName||'';
            document.getElementById('motherName').value=data.motherName||'';
            document.getElementById('studentClass').value=data.studentClass||'';
            document.getElementById('section').value=data.section||'';
            document.getElementById('department').value=data.department||'';
            document.getElementById('rollNo').value=data.rollNo||'';
            document.getElementById('leaveType').value=data.leaveType||'‡¶Ö‡¶∏‡ßÅ‡¶∏‡ßç‡¶•‡¶§‡¶æ‡¶∞ ‡¶õ‡ßÅ‡¶ü‡¶ø';
            document.getElementById('singleDate').value=data.singleDate||'';
            document.getElementById('startDate').value=data.startDate||'';
            document.getElementById('endDate').value=data.endDate||'';
            document.getElementById('totalDays').value=data.totalDays||'';
            document.getElementById('reason').value=data.reason||'';
            document.getElementById('schoolName').value=data.schoolName||'‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£ ‡¶â‡¶ö‡ßç‡¶ö ‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ‡¶≤‡¶Ø‡¶º';
            document.getElementById('schoolAddress').value=data.schoolAddress||'‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ: ‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£, ‡¶ú‡ßá‡¶≤‡¶æ: ‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£';
            if(data.margin){document.getElementById('marginSlider').value=data.margin;updateMargin(data.margin)}
            if(data.lineHeight){document.getElementById('lineHeightSlider').value=data.lineHeight;updateLineHeight(data.lineHeight)}
            if(data.fontSize){document.getElementById('fontSizeSlider').value=data.fontSize;updateFontSize(data.fontSize)}
            if(data.leaveDuration==='multiple'){document.querySelector('input[name="leaveDuration"][value="multiple"]').checked=true}else{document.querySelector('input[name="leaveDuration"][value="single"]').checked=true}
            toggleDateFields()
        }
        
        function saveApplication(){
            var name=document.getElementById('saveName').value.trim();
            var studentName=document.getElementById('studentName').value.trim();
            if(!name){name=studentName||'‡¶Ü‡¶¨‡ßá‡¶¶‡¶®'}
            if(!studentName){showToast('‚ö†Ô∏è ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ‡¶∞‡ßç‡¶•‡ßÄ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®!','error');return}
            var data=getFormData();
            data.saveName=name;
            data.id=Date.now();
            data.savedDate=new Date().toLocaleString('bn-BD');
            var saved=JSON.parse(localStorage.getItem('studentLeaveApps')||'[]');
            saved.unshift(data);
            localStorage.setItem('studentLeaveApps',JSON.stringify(saved));
            document.getElementById('saveName').value='';
            renderSavedList();
            showToast('‚úÖ "'+name+'" ‡¶∏‡ßá‡¶≠ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!','success')
        }
        
        function loadApplication(id){
            var saved=JSON.parse(localStorage.getItem('studentLeaveApps')||'[]');
            var app=saved.find(function(a){return a.id===id});
            if(app){loadFormData(app);showToast('‚úÖ "'+app.saveName+'" ‡¶≤‡ßã‡¶° ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!','success')}
        }
        
        function deleteApplication(id){
            if(!confirm('‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶è‡¶á ‡¶Ü‡¶¨‡ßá‡¶¶‡¶®‡¶ü‡¶ø ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶§‡ßá ‡¶ö‡¶æ‡¶®?'))return;
            var saved=JSON.parse(localStorage.getItem('studentLeaveApps')||'[]');
            var app=saved.find(function(a){return a.id===id});
            saved=saved.filter(function(a){return a.id!==id});
            localStorage.setItem('studentLeaveApps',JSON.stringify(saved));
            renderSavedList();
            showToast('üóëÔ∏è ‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!','success')
        }
        
        function renderSavedList(){
            var saved=JSON.parse(localStorage.getItem('studentLeaveApps')||'[]');
            var listEl=document.getElementById('savedList');
            var counterEl=document.getElementById('counter');
            counterEl.textContent='‡¶∏‡¶∞‡ßç‡¶¨‡¶Æ‡ßã‡¶ü: '+toBengaliNumber(saved.length)+'‡¶ü‡¶ø';
            if(saved.length===0){listEl.innerHTML='<div class="no-saved">‡¶ï‡ßã‡¶®‡ßã ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ ‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ‡¶®‡ßá‡¶á</div>';return}
            listEl.innerHTML=saved.map(function(app,i){
                return'<div class="saved-item"><div class="saved-info"><div class="saved-name">'+(i+1)+'. '+app.saveName+'</div><div class="saved-date">'+app.savedDate+' | '+app.leaveType+'</div></div><div class="saved-actions"><button class="btn-load" onclick="loadApplication('+app.id+')">‡¶≤‡ßã‡¶°</button><button class="btn-delete" onclick="deleteApplication('+app.id+')">‚úï</button></div></div>'
            }).join('')
        }
        
        function exportJSON(){
            var saved=JSON.parse(localStorage.getItem('studentLeaveApps')||'[]');
            if(saved.length===0){showToast('‚ö†Ô∏è ‡¶ï‡ßã‡¶®‡ßã ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ ‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ‡¶®‡ßá‡¶á!','error');return}
            var dataStr=JSON.stringify(saved,null,2);
            var blob=new Blob([dataStr],{type:'application/json'});
            var url=URL.createObjectURL(blob);
            var a=document.createElement('a');
            a.href=url;
            a.download='student_leave_apps_'+new Date().toISOString().slice(0,10)+'.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showToast('üì§ JSON ‡¶´‡¶æ‡¶á‡¶≤ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!','success')
        }
        
        function importJSON(event){
            var file=event.target.files[0];
            if(!file)return;
            var reader=new FileReader();
            reader.onload=function(e){
                try{
                    var imported=JSON.parse(e.target.result);
                    if(!Array.isArray(imported)){showToast('‚ùå ‡¶Ö‡¶¨‡ßà‡¶ß JSON ‡¶´‡¶æ‡¶á‡¶≤!','error');return}
                    var saved=JSON.parse(localStorage.getItem('studentLeaveApps')||'[]');
                    imported.forEach(function(app){
                        app.id=Date.now()+Math.random();
                        app.savedDate=new Date().toLocaleString('bn-BD')
                    });
                    saved=imported.concat(saved);
                    localStorage.setItem('studentLeaveApps',JSON.stringify(saved));
                    renderSavedList();
                    showToast('‚úÖ '+toBengaliNumber(imported.length)+'‡¶ü‡¶ø ‡¶Ü‡¶¨‡ßá‡¶¶‡¶® ‡¶á‡¶Æ‡ßç‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!','success')
                }catch(err){showToast('‚ùå JSON ‡¶´‡¶æ‡¶á‡¶≤ ‡¶™‡¶°‡¶º‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ!','error')}
            };
            reader.readAsText(file);
            event.target.value=''
        }
        
        document.getElementById('leaveForm').addEventListener('submit',function(e){e.preventDefault();var s='single'===document.querySelector('input[name="leaveDuration"]:checked').value,d={studentName:document.getElementById('studentName').value,fatherName:document.getElementById('fatherName').value,motherName:document.getElementById('motherName').value,studentClass:document.getElementById('studentClass').value,section:document.getElementById('section').value,department:document.getElementById('department').value,rollNo:document.getElementById('rollNo').value,leaveType:document.getElementById('leaveType').value,isSingleDay:s,singleDate:formatDate(document.getElementById('singleDate').value),startDate:formatDate(document.getElementById('startDate').value),endDate:formatDate(document.getElementById('endDate').value),totalDays:document.getElementById('totalDays').value,reason:document.getElementById('reason').value,schoolName:document.getElementById('schoolName').value,schoolAddress:document.getElementById('schoolAddress').value,applicationDate:getBengaliDate()},t=toBengaliNumber(d.totalDays),dept=d.department?d.department+' ‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó‡ßá‡¶∞ ':'',dur=d.isSingleDay?'<stron>'+d.singleDate+'</stron> ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ‡ßá ‡¶è‡¶ï‡¶¶‡¶ø‡¶®‡ßá‡¶∞ <stron>'+d.leaveType+'</stron> ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®‡•§':'<stron>'+d.startDate+'</stron> ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶π‡¶§‡ßá <stron>'+d.endDate+'</stron> ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶™‡¶∞‡ßç‡¶Ø‡¶®‡ßç‡¶§ ‡¶Æ‡ßã‡¶ü <stron>'+t+'</stron> ‡¶¶‡¶ø‡¶®‡ßá‡¶∞ <stron>'+d.leaveType+'</stron> ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®‡•§',pr=d.isSingleDay?'‡¶¨‡¶ø‡¶ß‡¶æ‡ßü ‡¶™‡ßç‡¶∞‡¶æ‡¶∞‡ßç‡¶•‡¶®‡¶æ, ‡¶Ü‡¶Æ‡¶æ‡¶ï‡ßá ‡¶â‡¶ï‡ßç‡¶§ ‡¶è‡¶ï‡¶¶‡¶ø‡¶®‡ßá‡¶∞ '+d.leaveType+' ‡¶Æ‡¶û‡ßç‡¶ú‡ßÅ‡¶∞ ‡¶ï‡¶∞‡ßá ‡¶¨‡¶æ‡¶ß‡¶ø‡¶§ ‡¶ï‡¶∞‡¶¨‡ßá‡¶®‡•§':'‡¶¨‡¶ø‡¶ß‡¶æ‡ßü ‡¶™‡ßç‡¶∞‡¶æ‡¶∞‡ßç‡¶•‡¶®‡¶æ, ‡¶Ü‡¶Æ‡¶æ‡¶ï‡ßá ‡¶â‡¶ï‡ßç‡¶§ '+t+' ‡¶¶‡¶ø‡¶®‡ßá‡¶∞ '+d.leaveType+' ‡¶Æ‡¶û‡ßç‡¶ú‡ßÅ‡¶∞ ‡¶ï‡¶∞‡ßá ‡¶¨‡¶æ‡¶ß‡¶ø‡¶§ ‡¶ï‡¶∞‡¶¨‡ßá‡¶®‡•§',h='<div class="letter-date">‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: '+d.applicationDate+'</div><div style="margin-bottom:15px">‡¶¨‡¶∞‡¶æ‡¶¨‡¶∞,<br>‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶® ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶ï,<br>'+d.schoolName+'<br>'+d.schoolAddress+'</div><div class="letter-subject">‡¶¨‡¶ø‡¶∑‡¶Ø‡¶º: <stron>'+d.leaveType+'</stron>‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶¨‡ßá‡¶¶‡¶®‡•§</div><div style="margin-bottom:15px">‡¶Æ‡¶π‡ßã‡¶¶‡¶Ø‡¶º,</div><div class="letter-body">‡¶¨‡¶ø‡¶®‡ßÄ‡¶§ ‡¶®‡¶ø‡¶¨‡ßá‡¶¶‡¶® ‡¶è‡¶á ‡¶Ø‡ßá, ‡¶Ü‡¶Æ‡¶ø <stron>'+d.studentName+'</stron>, ‡¶™‡¶ø‡¶§‡¶æ-'+d.fatherName+', ‡¶Æ‡¶æ‡¶§‡¶æ-'+d.motherName+', ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ‡¶≤‡¶Ø‡¶º‡ßá‡¶∞ <stron>'+d.studentClass+'</stron> ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡¶ø‡¶∞ <stron>'+d.section+'</stron> ‡¶∂‡¶æ‡¶ñ‡¶æ‡¶∞ '+dept+'‡¶è‡¶ï‡¶ú‡¶® ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ‡¶∞‡ßç‡¶•‡ßÄ‡•§ ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶∞‡ßã‡¶≤ ‡¶®‡¶Ç <stron>'+toBengaliNumber(d.rollNo)+'</stron>‡•§ ‡¶Ü‡¶Æ‡¶æ‡¶∞ <stron>'+d.reason+'</stron> ‡¶ï‡¶æ‡¶∞‡¶£‡ßá '+dur+'</div><div class="letter-body">'+pr+'</div><div class="letter-body" style="margin-bottom:30px">‡¶ß‡¶®‡ßç‡¶Ø‡¶¨‡¶æ‡¶¶‡¶æ‡¶®‡ßç‡¶§‡ßá,</div><div class="letter-signature"><div>‡¶¨‡¶ø‡¶®‡ßÄ‡¶§,</div><div style="margin-top:40px"><stron>( '+d.studentName+' )</stron></div><div>'+d.studentClass+' ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡¶ø, ‡¶∂‡¶æ‡¶ñ‡¶æ '+d.section+', ‡¶∞‡ßã‡¶≤: '+toBengaliNumber(d.rollNo)+'</div></div>';document.getElementById('applicationLetter').innerHTML=h;document.getElementById('placeholder').style.display='none';document.getElementById('output').style.display='block'});
        
        function resetForm(){document.getElementById('leaveForm').reset();document.getElementById('schoolName').value='‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£ ‡¶â‡¶ö‡ßç‡¶ö ‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ‡¶≤‡¶Ø‡¶º';document.getElementById('schoolAddress').value='‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ: ‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£, ‡¶ú‡ßá‡¶≤‡¶æ: ‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£';document.getElementById('placeholder').style.display='block';document.getElementById('output').style.display='none';toggleDateFields()}
        
        function updateMargin(v){document.documentElement.style.setProperty('--margin-size',v+'px');document.getElementById('marginValue').textContent=v+'px'}
        function updateLineHeight(v){document.documentElement.style.setProperty('--line-height',v);document.getElementById('lineHeightValue').textContent=parseFloat(v).toFixed(1)}
        function updateFontSize(v){document.documentElement.style.setProperty('--font-size',v+'px');document.getElementById('fontSizeValue').textContent=v+'px'}
        
        toggleDateFields();updateMargin(20);updateLineHeight(2);updateFontSize(16);renderSavedList();
    </script>
</body>
</html>
